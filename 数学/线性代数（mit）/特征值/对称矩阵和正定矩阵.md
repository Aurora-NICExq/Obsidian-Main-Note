---
tags:
  - LinearAlgebra
  - eigenvalues
---

## 对称矩阵的性质

^d38018

1. **特征值（Eigenvalues）全是实数**（没有虚数）。
   
2. **特征向量（Eigenvectors）相互正交**（即可以选出一组标准正交基）。

### 谱定理
对称矩阵的特征向量矩阵 $S$ 可以变为正交矩阵 $Q$（列向量正交且单位化）[[对称矩阵和正定矩阵#^d38018|对称矩阵性质2]]，所以对角化公式可以变换为[[正交矩阵的性质]]：
$$A = Q \Lambda Q^T$$

### 谱定理的几何表达
根据谱定理公式：$$A = \begin{bmatrix} | & & | \\ q_1 & \dots & q_n \\ | & & | \end{bmatrix} \begin{bmatrix} \lambda_1 & & \\ & \ddots & \\ & & \lambda_n \end{bmatrix} \begin{bmatrix} - & q_1^T & - \\ & \vdots & \\ - & q_n^T & - \end{bmatrix}$$
使用矩阵乘法展开，得到：$$A = \lambda_1 (q_1 q_1^T) + \lambda_2 (q_2 q_2^T) + \dots + \lambda_n (q_n q_n^T)$$
因为$q$ 是单位向量，所以 $qq^T$ 就是**投影到 $q$ 这条直线上的投影矩阵**。[[投影、投影矩阵#^36ed38|投影矩阵]]

#### 结论
**$A$ 是 $n$ 个投影矩阵的线性组合，系数就是特征值。**


## 实对称矩阵
**实对称矩阵（$A=A^T$）** **保证**了特征值必须是纯实数。

### 证明逻辑
- 假设 $Ax = \lambda x$（这里 $\lambda$ 和 $x$ 可能是复数）。
- 取共轭转置
-  两边做点积，最后推导出 $\lambda x^H x = \bar{\lambda} x^H x$。
- 因为 $x^H x$ 是长度的平方（实数且非零），所以只能是 $\lambda = \bar{\lambda}$。
- 一个数等于它的共轭，那它必须是**实数**。

##### Hermitian 矩阵
- 实数对称：$A = A^T$
- 复数对称（Hermitian）：$A = \bar{A}^T$ （共轭转置）

实对称矩阵只是 Hermitian 矩阵在实数域的一个特例

### 主元与特征值
对称矩阵中，主元的符号与特征值的符号一致
主元的乘积与特征值的乘积都等于$\det A$


## 正定矩阵

#### 正定矩阵的条件
- 是对称矩阵
- 所以特征值为正数

#### 判定方式
四个等价判定条件

|**判定角度**|**具体的条件**|**意义**|
|---|---|---|
|**1. 特征值视角**|所有特征值 $\lambda_i > 0$|谱理论视角，最直观但不易计算。|
|**2. 能量视角 (定义)**|对任意 $x \neq 0$，都有 $x^T A x > 0$|这是一个核心定义，Strang 称之为“能量”。|
|**3. 行列式视角**|所有**顺序主子式** (Leading Principal Minors) $> 0$|易于手动计算（针对小矩阵）。|
|**4. 消元视角**|所有**主元** (Pivots) $> 0$|计算机视角的判定，最快的方法。|



### 引入 $x^T A x$ （二次型）

二次型的表达式：对于一个向量 $x$，我们不仅仅是看 $Ax$，而是要看 **$x^T A x$**。

- 这是一个**纯量 (Number)**，而不是向量。

- 展开 $2 \times 2$ 的例子来展示纯量的内部结构：

  

  $$x^T A x = \begin{bmatrix} x_1 & x_2 \end{bmatrix} \begin{bmatrix} a & b \\ b & c \end{bmatrix} \begin{bmatrix} x_1 \\ x_2 \end{bmatrix} = ax_1^2 + 2bx_1x_2 + cx_2^2$$

**这就是二次型**。它只有二次项（$x^2, xy, y^2$），没有线性项或常数项。

#### 正定矩阵的“真正定义” 

> **如果对于所有的非零向量 $x$，都有 $x^T A x > 0$，那么矩阵 $A$ 就是正定的。**



## 几何直观：碗（Bowl）与马鞍面（Saddle）

- **正定矩阵：** $x^T A x$ 的图像像一个“碗”（Paraboloid），它有一个唯一的最低点（原点）。比如 $f(x,y) = 2x^2 + 2xy + 2y^2$。

![Gemini_Generated_Image_k53uihk53uihk53u](attachments/Gemini_Generated_Image_k53uihk53uihk53u.png)

碗在每一个方向的变化速率不一定均匀

#### 特征值决定“陡峭程度” (Curvature)

**特征值 $\lambda$可以 理解为这个碗在特定方向上的**曲率 (Curvature)** 或 **陡峭程度**。

假设我们已经通过旋转坐标轴（利用特征向量 $Q$），把二次型化简为标准型：



$$z = \lambda_1 y_1^2 + \lambda_2 y_2^2 + \dots + \lambda_n y_n^2$$

- **$\lambda_{max}$ (最大特征值)**：代表碗**最陡峭**的方向。在这个方向上移动一点点，高度 $z$ 就会剧烈增加。
- **$\lambda_{min}$ (最小特征值)**：代表碗**最平缓**的方向。在这个方向上移动，高度增加得很慢，像在一个平缓的山谷底部。

> 



- **不定矩阵：** 如果特征值一正一负，图像就像一个“马鞍”（Saddle Point），在一个方向向上弯曲，另一个方向向下弯曲。

![Gemini_Generated_Image_xsrms6xsrms6xsrm](attachments/Gemini_Generated_Image_xsrms6xsrms6xsrm.png)

- **直观联系：** 代数上的“正定”，就是几何上的“向上弯曲”。



### 水平截切法（Horizontal Slicing）

我们用一个水平面（例如 $z=1$）去切这个曲面时，切口会是不同形状



####  切口

二次型函数：

$$f(x, y) = ax^2 + 2bxy + cy^2$$

如果我们考察高度为 1 的截面，即令 $f(x, y) = 1$，我们在 $xy$ 平面上会看到什么曲线？

$$ax^2 + 2bxy + cy^2 = 1$$



#### 正定矩阵 $\rightarrow$ 椭圆 (Ellipse)

正定矩阵： $\begin{bmatrix} 2 & 1 \\ 1 & 2 \end{bmatrix}$

对应的截面方程是：



$$2x^2 + 2xy + 2y^2 = 1$$

- **几何形状**：因为各项系数“足够正”，$x$ 和 $y$ 不能无限大。如果 $x$ 很大，$2x^2$ 就会很大，方程就不可能等于 1。因此，图形必须是**封闭**的。
- **结论**：这是一个**椭圆 (Ellipse)**。
- **3D 联系**：既然切面是封闭的椭圆，且随着截面高度增加（$z=2, 3...$），椭圆越来越大，说明整个 3D 图形是一个向上开口的**碗 (Bowl)**。
- **代数判据**：这对应于 $ac - b^2 > 0$（行列式大于 0）且 $a > 0$。

------

#### 不定矩阵 $\rightarrow$ 双曲线 (Hyperbola)

不定矩阵 $\begin{bmatrix} 2 & 3 \\ 3 & 2 \end{bmatrix}$

行列式 $4 - 9 = -5 < 0$。

对应的截面方程是：



$$2x^2 + 6xy + 2y^2 = 1$$

- **几何形状**：由于中间项 $6xy$ 很大且可能为负（当 $x, y$ 异号时），$2x^2$ 和 $2y^2$ 不足以“拉住”函数值。$x$ 和 $y$ 可以趋向无穷大而保持方程成立。
- **结论**：这是一个**双曲线 (Hyperbola)**。它不是封闭的，它有渐近线，延伸到无穷远。
- **3D 联系**：
  - 在某些方向（双曲线实轴），函数值上升。
  - 在另一些方向（渐近线之间），函数值甚至无法达到 1（可能变成负数）。
  - 这说明 3D 图形是**马鞍面 (Saddle)**。
- **代数判据**：这对应于 $ac - b^2 < 0$（行列式小于 0）。



#### **主轴定理 (Principal Axis Theorem)** 

- 椭圆 $2x^2 + 2xy + 2y^2 = 1$ 是倾斜的（因为有交叉项 $2xy$）。
- 旋转坐标系，去掉 $xy$ 项，把椭圆摆正
- **方法**：特征值分解（$Q \Lambda Q^T$）
  - 特征向量的方向 $\rightarrow$ 椭圆的**长轴和短轴**方向。
  - 特征值的大小 $\rightarrow$ 决定了椭圆轴的**长度**（特征值越大，轴越短，因为 $\lambda x^2 = 1 \implies x = 1/\sqrt{\lambda}$）。

### 



## 二次型极小值的判别



### 多元微积分 (Multivariable Calculus)

现在考虑二元函数 $f(x, y)$ 或多元函数 $f(\mathbf{x})$。

我们要寻找极小值点，同样需要两个条件：

#### 第一步：一阶导数变为“梯度”

要让切平面水平，必须在所有方向上的偏导数都为 0：



$$\frac{\partial f}{\partial x} = 0 \quad \text{且} \quad \frac{\partial f}{\partial y} = 0$$



写成向量形式即梯度为零向量：$\nabla f = \mathbf{0}$。

#### 第二步：二阶导数变为“矩阵”

一元函数的 $f''(x)$ 在多元函数中变成了什么？

考虑所有的二阶偏导数：$f_{xx}, f_{xy}, f_{yx}, f_{yy}$。

将它们排列成一个 $n \times n$ 的对称矩阵，称为海森矩阵 (Hessian Matrix)。

$$H = \begin{bmatrix} \frac{\partial^2 f}{\partial x^2} & \frac{\partial^2 f}{\partial x \partial y} \\ \frac{\partial^2 f}{\partial y \partial x} & \frac{\partial^2 f}{\partial y^2} \end{bmatrix} = \begin{bmatrix} f_{xx} & f_{xy} \\ f_{yx} & f_{yy} \end{bmatrix}$$

> **注意**：对于光滑函数，混合偏导数相等 ($f_{xy} = f_{yx}$)，所以**海森矩阵是对称矩阵**。



### 泰勒级数 (Taylor Series)

一元泰勒展开 (近似到二次项)：



$$f(x) \approx f(0) + f'(0)x + \frac{1}{2}f''(0)x^2$$



在驻点，$f'(0)=0$，所以 $f(x) \approx f(0) + \frac{1}{2} \cdot (\text{二阶导数}) \cdot x^2$。

显然，要让 $f(x) > f(0)$（即 $f(0)$ 是极小值），必须要求 $(\text{二阶导数}) > 0$。

多元泰勒展开 (矩阵形式)：

向量形式的展开式：



$$f(\mathbf{x}) \approx f(\mathbf{0}) + (\nabla f)^T \mathbf{x} + \frac{1}{2} \mathbf{x}^T H \mathbf{x}$$

在驻点，梯度项 $(\nabla f)^T \mathbf{x}$ 消失了。剩下的决定性因素就是二次型项：



$$\Delta f = f(\mathbf{x}) - f(\mathbf{0}) \approx \frac{1}{2} \mathbf{x}^T H \mathbf{x}$$

**逻辑闭环：**

- 为了让 $f(\mathbf{0})$ 成为**局部极小值**。
- 我们需要对于任何微小的扰动 $\mathbf{x} \neq 0$，都有 $\Delta f > 0$。
- 即要求 $\mathbf{x}^T H \mathbf{x} > 0$ 对所有非零向量 $\mathbf{x}$ 成立。
- **这正是正定矩阵的定义**



#### 总结表格

| **概念**        | **一元微积分 (y=f(x))**   | **多元微积分 / 线性代数 (z=f(x,y))**     |
| --------------- | ------------------------- | ---------------------------------------- |
| **临界点条件**  | $f'(x) = 0$               | 梯度 $\nabla f = 0$ (偏导数全为0)        |
| **二阶对象**    | 二阶导数 $a = f''$ (标量) | **海森矩阵** $A = H$ (矩阵)              |
| **极小值条件**  | $a > 0$                   | **矩阵 $A$ 是正定矩阵**                  |
| **极大值条件**  | $a < 0$                   | **矩阵 $A$ 是负定矩阵**                  |
| **鞍点 (拐点)** | $a = 0$ (需更高阶测试)    | **矩阵 $A$ 是不定矩阵** (特征值有正有负) |





#### 课堂示例

计算：$$f(x, y) = 2x^2 + 2xy + 2y^2$$

1. 一阶导数：

   $\frac{\partial f}{\partial x} = 4x + 2y = 0$

   $\frac{\partial f}{\partial y} = 2x + 4y = 0$

   唯一解是 $(0,0)$。

2. 二阶导数 (海森矩阵)：

   $f_{xx} = 4, \quad f_{xy} = 2$

   $f_{yx} = 2, \quad f_{yy} = 4$

   矩阵 $H = \begin{bmatrix} 4 & 2 \\ 2 & 4 \end{bmatrix}$。

3. **判定**：

   - 主元：$4 > 0$，行列式 $16-4=12 > 0$。
   - 或者特征值：$\lambda_1=2, \lambda_2=6$ 均大于0。
   - **结论**：$H$ 是正定矩阵，所以 $(0,0)$ 是真正的**极小值点**，函数图像是个“碗”。

如果损失函数的海森矩阵条件数（最大特征值/最小特征值）很大，这里的“碗”就会变成一个非常狭长的“峡谷”，导致梯度下降收敛非常慢（在峡谷壁上震荡）。[[优化算法梯度下降法]]





## 多项式的配方与高斯消元

对一个二次多项式进行**“配方”（Completing the Square）**时，你实际上是在手动执行**高斯消元法（Gaussian Elimination）**。

具体对应关系：

1. **括号外的系数**：就是矩阵的**主元 (Pivots)**。
2. **括号内变量的系数**：就是消元过程中用到的**乘数 (Multipliers, $l_{ij}$)**。



### 举例

设矩阵 $A = \begin{bmatrix} 2 & 6 \\ 6 & 20 \end{bmatrix}$，对应的二次型是 $f(x,y) = 2x^2 + 12xy + 20y^2$。

#### 左边：代数法（配方）

把 $x$ 和 $y$ 拆开，凑成平方和。

1. 提取第一项系数（这就是第一个主元）：

   $2(x^2 + 6xy) + 20y^2$

2. 凑平方：

   为了凑出 $(x + ?y)^2$，我需要在括号里加一项。

   $x^2 + 6xy$ 对应的完全平方形式是 $(x + \mathbf{3}y)^2 = x^2 + 6xy + 9y^2$。

   所以：

   $2(\underbrace{x^2 + 6xy + 9y^2}_{\text{凑成平方}} - 9y^2) + 20y^2$

3. 整理：

   $2(x + \mathbf{3}y)^2 - 18y^2 + 20y^2$

   $= \mathbf{2}(x + \mathbf{3}y)^2 + \mathbf{2}y^2$

> **注意三个数字**：
>
> - 括号外的系数：**2** 和 **2**。
> - 括号内 $y$ 的系数：**3**。

------

#### 右边：矩阵法（消元）

对 $A = \begin{bmatrix} 2 & 6 \\ 6 & 20 \end{bmatrix}$ 进行高斯消元。

1. 第一步消元：

   消掉第二行的 $6$。

   第一行的主元是 2。

   计算乘数 (Multiplier) $l_{21}$：

   

   $$l_{21} = \frac{\text{待消元素}}{\text{主元}} = \frac{6}{2} = \mathbf{3}$$

   

   操作：$Row_2 - \mathbf{3} \times Row_1$。

2. 得到结果：

   $\begin{bmatrix} 2 & 6 \\ 6 - 3\times2 & 20 - 3\times6 \end{bmatrix} = \begin{bmatrix} \mathbf{2} & 6 \\ 0 & \mathbf{2} \end{bmatrix} = U$

> **对比一下**：
>
> - 主元 (Pivots)：**2** 和 **2**。
> - 乘数 (Multiplier)：**3**



#### 结论

$$f(x, y) = \underbrace{2}_{\text{主元1}} (x + \underbrace{3}_{\text{乘数}} y)^2 + \underbrace{2}_{\text{主元2}} y^2$$

通用的公式：



$$x^T A x = (\text{Pivot}_1)(x + l_{21}y)^2 + (\text{Pivot}_2)(y)^2$$

即矩阵分解 $A = LDL^T$ 的多项式表达形式

- **$D$ (Diagonal)**：对角矩阵，存放主元 $d_1, d_2$。
- **$L$ (Lower triangular)**：下三角矩阵，存放乘数 $l_{ij}$。

#### 作用：

判断正定性

- 只需要做消元，所有的主元 (Pivots) 都是正数，那么配方后的结果一定是：

  $(\text{正数})(\dots)^2 + (\text{正数})(\dots)^2$

  这保证了结果永远大于 0（即矩阵是正定的）。
