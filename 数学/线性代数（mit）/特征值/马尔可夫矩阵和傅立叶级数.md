---
tags:
  - LinearAlgebra
  - eigenvalues
---

## 马尔可夫矩阵



### 马尔可夫矩阵的性质



#### 定义

一个矩阵 $A$ 如果满足以下两个条件，则被称为马尔科夫矩阵：

1. **非负性**：矩阵中的每一个元素 $a_{ij} \geq 0$。

2. **列和为1**：每一列的元素之和等于 1。

   - 部分教材定义行和为1，公开课以“列和为1”为准，配合列向量 $u_{k+1} = A u_k$ 使用。

   

   

#### 性质

1. **必然存在 $\lambda = 1$**：

- **证明思路**：因为 $A$ 的每一列之和为 1，那么 $A - 1I$ 的每一列之和为 0。这意味着 $A - I$ 的行向量线性相关（行向量之和为零向量），因此 $A - I$ 是奇异矩阵，$\det(A-I)=0$，所以 $1$ 是特征值。 [[特征值和特征向量#^f0e380|特征值的求解]]

- 利用矩阵转置的性质证明：

  - **定义**：设 $A$ 是一个 $n \times n$ 的马尔可夫矩阵，每一列的元素之和为 1。

  - **观察**：既然每一列的和为 1，如果我们把 $A$ 转置成 $A^T$，那么 $A^T$ 的每一**行**之和就为 1。

  - **构造特征向量**：对于 $A^T$，如果我们取一个全为 1 的向量 $\mathbf{v} = [1, 1, \dots, 1]^T$，做乘法：

    $$  A^T \mathbf{v} = \begin{bmatrix} \text{row}_1 \\ \text{row}_2 \\ \vdots \end{bmatrix} \begin{bmatrix} 1 \\ 1 \\ \vdots \end{bmatrix} = \begin{bmatrix} \sum \text{row}_1 \\ \sum \text{row}_2 \\ \vdots \end{bmatrix} = \begin{bmatrix} 1 \\ 1 \\ \vdots \end{bmatrix} = 1 \cdot \mathbf{v}$$

    这意味着 $\lambda = 1$ 是 $A^T$ 的一个特征值。

  - **结论**：因为矩阵 $A$ 和它的转置 $A^T$ 拥有**相同的特征多项式**，也就拥有**相同的特征值**。所以，$\lambda = 1$ 也一定是 $A$ 的特征值。



2. **所有特征值的模 $|\lambda| \leq 1$**：

- 这保证了在多次迭代后，系统不会发散到无穷大。

- **证明思路**：**盖尔圆盘定理 (Gershgorin Circle Theorem)**

  矩阵的所有特征值都分布在复平面上的一系列圆盘内。对于矩阵 $A$（和为 1 的 $A^T$）：

  - **圆心**：是对角线元素 $a_{ii}$。
  - **半径**：是该行非对角线元素的绝对值之和 $R_i = \sum_{j \neq i} |a_{ij}|$。

  对于马尔可夫矩阵：

  1. 所有元素非负，且行和为 1。

  2. 所以，半径 $R_i = 1 - a_{ii}$。

  3. 圆盘上的任意点 $z$ 到原点的距离（模长）最大为：

     $$|z| \le \text{圆心} + \text{半径} = a_{ii} + (1 - a_{ii}) = 1$$

  4. 因为所有圆盘都在单位圆 $|z| \le 1$ 内，所以所有的特征值也都必须在单位圆内。

![Gemini_Generated_Image_usihqousihqousih-7090284](attachments/Gemini_Generated_Image_usihqousihqousih-7090284-7233718.png)



#### **稳态 (Steady State)**

我们研究差分方程 $u_{k+1} = A u_k$，初始向量为 $u_0$。

将 $u_0$ 用特征向量展开：



$$u_0 = c_1 x_1 + c_2 x_2 + \dots + c_n x_n$$



经过 $k$ 次迭代后：



$$u_k = A^k u_0 = c_1 (1)^k x_1 + c_2 (\lambda_2)^k x_2 + \dots + c_n (\lambda_n)^k x_n$$



- **推导**：

  - 设 $\lambda_1 = 1$ 是主特征值，$x_1$ 是对应的特征向量。
  - 其他特征值 $|\lambda_i| < 1$。
  - 当 $k \to \infty$ 时，$(\lambda_i)^k \to 0$（对于 $i \neq 1$）。

- 结论：

  $$u_{\infty} = c_1 x_1$$

  这被称为稳态 (Steady State)。无论初始状态如何（只要 $c_1 \neq 0$），系统最终都会收敛到与 $\lambda=1$ 对应的特征向量 $x_1$ 的方向上。

#### **人口迁移的例题**

- **设定**：加州 (Cal) 和 马萨诸塞州 (Mass) 的人口迁移。

  - 加州人有 0.9 留在加州，0.1 搬去 Mass。
  - Mass人有 0.8 留在 Mass，0.2 搬去加州。

- 矩阵构造：

  

  $$A = \begin{bmatrix} 0.9 & 0.2 \\ 0.1 & 0.8 \end{bmatrix}$$

  

  (注意：列1代表来自Cal的流向，列2代表来自Mass的流向；列和均为1)

- 求解稳态：

  我们需要求 $\lambda=1$ 对应的特征向量，即求解 $(A - I)x = 0$：

  

  $$A - I = \begin{bmatrix} -0.1 & 0.2 \\ 0.1 & -0.2 \end{bmatrix}$$

  

  解得特征向量 $x_1 = \begin{bmatrix} 2 \\ 1 \end{bmatrix}$。

- **物理意义**：长期来看，加州人口将是 Mass 人口的 2 倍。即加州占总人口 2/3，Mass 占 1/3。



### **傅里叶级数 (Fourier Series)**

线性代数在无穷维向量空间（函数空间）中的应用。核心思想是**投影 (Projection)**。

#### **1. 核心思想**

任何周期函数 $f(x)$ 都可以展开为正弦和余弦函数的无穷级数：



$$f(x) = a_0 + a_1 \cos x + b_1 \sin x + a_2 \cos 2x + b_2 \sin 2x + \dots$$

- **线性代数视角**：
  - **向量空间**：所有的函数 $f(x)$ 构成一个无穷维空间。
  - **基 (Basis)**：$1, \cos x, \sin x, \cos 2x, \sin 2x, \dots$ 是一组基。
  - **坐标**：系数 $a_k, b_k$ 就是函数 $f(x)$ 在这组基下的“坐标”。

#### **2. 正交性 (Orthogonality)**

这组基不仅仅是普通的基，它是正交基。

在函数空间中，向量点积（内积）定义为积分：



$$f \cdot g = \int_{0}^{2\pi} f(x)g(x) dx$$

关键性质：基函数两两正交。



$$\int_{0}^{2\pi} \cos(nx) \cos(kx) dx = 0 \quad (\text{if } n \neq k)$$

$$\int_{0}^{2\pi} \sin(nx) \cos(kx) dx = 0 \quad (\text{Always})$$

#### **3. 求解系数 (即“投影”)**

既然基是正交的，我们就可以像在 $\mathbb{R}^n$ 空间中一样，通过投影来求系数。

如果要通过 $f(x)$ 求系数 $a_1$（即 $\cos x$ 前的系数）：



$$a_1 = \frac{f(x) \cdot \cos x}{\cos x \cdot \cos x} = \frac{\int_{0}^{2\pi} f(x)\cos x \, dx}{\int_{0}^{2\pi} (\cos x)^2 \, dx}$$

- 分母 $\int_{0}^{2\pi} (\cos x)^2 dx = \pi$。

- 所以：

  

  $$a_k = \frac{1}{\pi} \int_{0}^{2\pi} f(x) \cos kx \, dx$$

  $$b_k = \frac{1}{\pi} \int_{0}^{2\pi} f(x) \sin kx \, dx$$

  $$a_0 = \frac{1}{2\pi} \int_{0}^{2\pi} f(x) \, dx \quad \text{(即函数的平均值)}$$

### 

#### 正交性的证明



验证傅里叶级数中的基函数（$1, \sin x, \cos x, \sin 2x, \cos 2x, \dots$）两两之间的积分是否为 0。

主要利用**三角函数的积化和差公式**。

##### **情况 A：不同频率的正弦与余弦 ($\sin nx$ 和 $\cos mx$)**

计算内积：



$$I = \int_{0}^{2\pi} \sin(nx) \cos(mx) \, dx$$



利用公式 $\sin A \cos B = \frac{1}{2}[\sin(A+B) + \sin(A-B)]$：



$$I = \frac{1}{2} \int_{0}^{2\pi} [\sin((n+m)x) + \sin((n-m)x)] \, dx$$

- **直观解释**：正弦函数 $\sin(kx)$ 在一个完整周期 $[0, 2\pi]$ 内的积分面积是 0（正负抵消）。
- 无论 $n, m$ 是什么整数，$(n+m)$ 和 $(n-m)$ 都是整数。
- 因此，这两个积分项都是 **0**。
- **结论**：正弦和余弦永远正交。

##### **情况 B：不同频率的余弦与余弦 ($\cos nx$ 和 $\cos mx$, $n \neq m$)**

计算内积：



$$I = \int_{0}^{2\pi} \cos(nx) \cos(mx) \, dx$$



利用公式 $\cos A \cos B = \frac{1}{2}[\cos(A-B) + \cos(A+B)]$：



$$I = \frac{1}{2} \int_{0}^{2\pi} [\cos((n-m)x) + \cos((n+m)x)] \, dx$$

- 只要 $n \neq m$，$(n-m)$ 就是非零整数。
- $\cos(kx)$ 在完整周期内的积分也是 0。
- **结论**：频率不同的余弦函数相互正交。

同理可证，不同频率的正弦函数之间也是正交的。

------

#### **3. 为什么是“基”？**

“正交”只说明它们互不干扰（独立的），要成为“基”，还需要**“完备性”**。

这意味着：在这个空间里的任何一个（表现良好的）周期函数，都可以被这组基“生成”出来。

就像三维空间里的任何向量都能用 $\vec{i}, \vec{j}, \vec{k}$ 表示一样，任何周期函数 $f(x)$ 都能写成：



$$f(x) = a_0 + \sum a_n \cos(nx) + \sum b_n \sin(nx)$$



并没有遗漏任何“方向”或“维度”。这个性质由傅里叶级数的收敛定理保证。



### 投影求解系数的公式证明

假设 $f(x)$ 是由无数个正弦余弦加起来的：



$$f(x) = a_0 + a_1 \cos x + \dots + \mathbf{a_k \cos(kx)} + \dots$$



**目标：** 想把混在一起的级数拆开，单独把 $\mathbf{a_k}$ 抓出来。

**操作：** 用 $\cos(kx)$ 去“乘并积分”等式两边。

$$\int_{0}^{2\pi} f(x) \cos(kx) dx = \int_{0}^{2\pi} \left[ a_0 + \dots + a_k \cos(kx) + \dots \right] \cos(kx) dx$$

利用积分的线性性质，把右边展开：

$$\text{Right Side} = \underbrace{\int a_0 \cos(kx)}_{0} + \dots + \underbrace{\int a_m \cos(mx)\cos(kx)}_{0 (\text{当 } m \neq k)} + \mathbf{a_k \int (\cos kx)^2} + \dots$$

由于正交性，除了自己乘自己那一项，其他所有项的积分结果全是 0

最后方程只剩下：



$$\int_{0}^{2\pi} f(x) \cos(kx) dx = a_k \cdot \int_{0}^{2\pi} (\cos kx)^2 dx$$

于是解出了 $a_k$：

$$a_k = \frac{\int_{0}^{2\pi} f(x) \cos(kx) dx}{\int_{0}^{2\pi} (\cos kx)^2 dx}$$

- 分子是 $f(x)$ 与基函数的“点积”。
- 分母是基函数长度的“平方”（模长平方）。
