---
tags:
  - Multivariable_Calculus
---

> **梯度是什么**、**方向导数怎么用梯度算**、梯度如何搞定**等值面/等值线的法向量与切平面**。

------

### 梯度的定义

链式法则：如果 $w=w(x,y,z)$，而 $\mathbf r(t)=(x(t),y(t),z(t))$，那么
$$
\frac{dw}{dt}=w_x\frac{dx}{dt}+w_y\frac{dy}{dt}+w_z\frac{dz}{dt}.
$$
把它改写成向量点积：
$$
\frac{dw}{dt}=\nabla w \cdot \frac{d\mathbf r}{dt}.
$$
并定义
$$
\nabla w=\langle w_x,\;w_y,\;w_z\rangle \quad\text{（梯度向量）}.
$$


**梯度“把各方向的偏导打包成一个向量”**

------

### 梯度的几何意义

**定理：** $\nabla w$ 在点处垂直于等值面 $w=c$。

**证明思路：**

- 取一条曲线 $\mathbf r(t)$ 完全落在等值面 $w=c$ 上，则 $w(\mathbf r(t))\equiv c$ 是常数，所以 $\frac{dw}{dt}=0$。
- 由向量链式法则 $\frac{dw}{dt}=\nabla w\cdot \mathbf v$（$\mathbf v=d\mathbf r/dt$ 是曲线的速度向量）得到 $\nabla w\cdot \mathbf v=0$。
- 而 $\mathbf v$ 是任意“沿等值面运动”的切向量，于是 $\nabla w$ 与切平面内所有切向量都垂直 ⇒ **$\nabla w$ 是等值面的法向量**。

**三个例子：**

- $w=ax+by+cz$：等值面 $w=d$ 是平面，法向量就是 $\langle a,b,c\rangle=\nabla w$。
- $w=x^2+y^2$：等值线是圆，$\nabla w=\langle 2x,2y\rangle$ 指向径向外侧，天然垂直圆。
- $w=x^2-y^2$：看等值线/等值面，梯度随点变化（强调梯度是“向量场”）。

#### 图像

![Gemini_Generated_Image_ahjn3ahjn3ahjn3a](attachments/Gemini_Generated_Image_ahjn3ahjn3ahjn3a.png)

------

### 应用

若曲面由“等值面”给出：$w(x,y,z)=c$，在点 $P(x_0,y_0,z_0)$ 处的切平面法向量就是 $\nabla w(P)$。

例子：曲面 $x^2+y^2-z^2=4$ 在 $(2,1,1)$ 的切平面。

- $w=x^2+y^2-z^2$，$\nabla w=\langle 2x,2y,-2z\rangle$，在点处是 $\langle 4,2,-2\rangle$。
- 切平面方程：

$$
4(x-2)+2(y-1)-2(z-1)=0 \;\;\Longleftrightarrow\;\; 4x+2y-2z=8.
$$



微分/线性近似”：先写 $dw\approx 4\Delta x+2\Delta y-2\Delta z$，等值面上 $\Delta w=0$，就得到同一个切平面。[[微分、链式法则#^aa8e28|线性近似得到切平面]]

------

### 方向导数

**定义设置：**
 取单位向量 $\hat{\mathbf u}=\langle a,b\rangle$，沿它以单位速度走：
$$
x(s)=x_0+as,\quad y(s)=y_0+bs
$$
其中 $s$ 是弧长（unit speed）。

方向导数记作 $\left.\dfrac{dw}{ds}\right|_{\hat{\mathbf u}}$，几何上是：把图像用“包含该方向的竖直平面”切开，切线斜率就是方向导数。（参考Python代码渲染图文件Directional_Derivative.py）

**计算公式：**
$$
\left.\frac{dw}{ds}\right|_{\hat{\mathbf u}}
=\nabla w \cdot \hat{\mathbf u}.
$$

梯度函数在$u$方向向量上的分量。


------

### 结论：最大上升方向、最大斜率与等值线切向

把点积写成夹角形式：
$$
\nabla w\cdot \hat{\mathbf u}=|\nabla w|\cos\theta.
$$


得到三条结论：

1. **最大上升方向**：当 $\cos\theta=1$（$\theta=0$）时最大 ⇒ $\hat{\mathbf u}$ 与 $\nabla w$ 同向。梯度方向就是“增长最快的方向”。
2. **最大上升率**：最大值等于 $|\nabla w|$。也就是说梯度长度就是“最陡的斜率”。
3. **不变方向**：当 $\cos\theta=0$（$\theta=90^\circ$）时方向导数为 0 ⇒ $\hat{\mathbf u}\perp \nabla w$。这正对应“沿等值线/等值面切向走，函数值不变”。

看等高线图时，**梯度永远垂直等值线，并指向数值更大的那边**。

------

### 做题步骤

- **求梯度**：$\nabla f=\langle f_x,f_y\rangle$ 或 $\langle f_x,f_y,f_z\rangle$。
- **方向导数**：先把方向单位化成 $\hat{\mathbf u}$，再算 $\nabla f\cdot \hat{\mathbf u}$。
- **切平面/法向量**：隐式曲面 $w=c$ 的法向量用 $\nabla w$，切平面用 $\nabla w(P)\cdot(\mathbf x-\mathbf x_0)=0$。
