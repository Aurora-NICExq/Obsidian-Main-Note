---
tags:
  - stm32
  - 标准库
---
# GPIO输出



## 简介

- GPIO（General Purpose Input Output）通用输入输出口 （即IO口）
- 可配置为8种输入输出模式
-  引脚电平：0V~3.3V，部分引脚可容忍5V  
  	1. 数据1是高电平，0是低电平
  	2. 输入可达5V,最大输出3.3V（引脚定义中带FT可以容忍） ^460c10

- 输出模式下可控制端口输出高低电平，用以驱动LED、控制蜂鸣器、模拟通信协议输出时序等

- 输入模式下可读取端口的高低电平或电压，用于读取按键输入、外接模块电平信号输入、ADC电压采集、模拟通信协议接收数据等



## 基本结构

![Gemini_Generated_Image_bjoo1bbjoo1bbjoo](Gemini_Generated_Image_bjoo1bbjoo1bbjoo.png)

- GPIO挂载在APB2外设总线上,每一个包含16个引脚
- 内核通过APB2总线对寄存器读写，实现输出电平和读取电平的功能
- 寄存器每一位对应一个引脚，寄存器是32位，低16位对应端口



## GPIO位结构

![image-20260122185547132](image-20260122185547132.png)

ADC用于模拟信号转数字信号

### 引脚和驱动器

#### 保护二极管

- 输入电压大于3.3V，上方二极管导通，电流流入VDD。（电流由电源吸收）
- 输入电压小于0V（相对于VSS），下方导通，电流从VSS流出。（电流由GND吸收） 

#### 上拉与下拉

- 上拉电阻接高电平
- 下拉电阻接低电平

#### TTF肖特基触发器

- 输入电压大于阈值，输出升为高电平
- 输入电压低于阈值，输出降为低电平

用于消抖，[[电压比较器]]

#### 模拟与数字信号
浮空、上拉、下拉读取高低电平，称为数字输入。
模拟输入读取电压具体数值

### 寄存器

输出数据寄存器同时控制16个端口，只能进行整体读写

位设置寄存器可用于单独修改一位数据，而不影响其它位



#### MOS管
推挽输出下P-MOS、N-MOS协同工作。
- IO口输出高电平，P激活，N关闭。VDD与IO引脚导通。
- IO口输出低电平，P关闭，N激活。VSS与IO引脚导通。

开漏输出用于VDD电压大小不够的情况。
- N- MOS工作，P-MOS断开
- IO口输出高电平，N断开，电路断路。
- IO口输出低电平，GND外接5V，电压“漏”进来。

1. **开漏输出依靠外部电源提供驱动能力，因此更加灵活**
2. 开漏输出需要使用能够容忍5V的IO口[[GPIO原理#^460c10|FT能够容忍5V]]
## GPIO模式

^c3df2c

- 配置GPIO的端口配置寄存器，可以将端口配置成8种模式

| **模式名称**     | **性质** | **特征**                                           |
| ---------------- | -------- | -------------------------------------------------- |
| **浮空输入**     | 数字输入 | 可读取引脚电平，若引脚悬空，则电平不确定           |
| **上拉输入**     | 数字输入 | 可读取引脚电平，内部连接上拉电阻，悬空时默认高电平 |
| **下拉输入**     | 数字输入 | 可读取引脚电平，内部连接下拉电阻，悬空时默认低电平 |
| **模拟输入**     | 模拟输入 | GPIO无效，引脚直接接入内部ADC                      |
| **开漏输出**     | 数字输出 | 可输出引脚电平，高电平为高阻态，低电平接VSS        |
| **推挽输出**     | 数字输出 | 可输出引脚电平，高电平接VDD，低电平接VSS           |
| **复用开漏输出** | 数字输出 | 由片上外设控制，高电平为高阻态，低电平接VSS        |
| **复用推挽输出** | 数字输出 | 由片上外设控制，高电平接VDD，低电平接VSS           |

1. 一个端口只能够有一个输出，但是可以有多个输入。
2. 除了模拟输入，其它七种模式输入均有效



# GPIO输入



## 硬件电路

![image-20260122204922933](image-20260122204922933.png)

- 按键按下时引脚是低电平，松手是高电平。 
- 外接上拉电阻，因此输入可以是浮空输入的模式。

